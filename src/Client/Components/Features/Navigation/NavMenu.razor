@using Microsoft.AspNetCore.Authorization

@attribute [Authorize]

<MudTextField T="string" Label="Search" Class="flex-grow-0 mt-2 ml-2" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" TextChanged="OnTextChanged" Immediate="true" Clearable="true" />
<MudTreeView T="TreeViewItemViewModel" @ref="_treeView" FilterFunc="MatchesName" ServerData="@LoadServerData" Items="@Repositories">
    <ItemTemplate>
        <MudTreeViewItem Value="@context.Value"
                         Text="@context.Value.Name"   
                         Items="@context.Children"
                         OnClick="@(()=> HandleItemClick(@context.Value))"
                         ItemsChanged="@(new Action<IReadOnlyCollection<TreeItemData<TreeViewItemViewModel>>>(items => OnItemsLoaded(context, items)))"
                         @bind-Expanded="@context.Expanded"
                         CanExpand="@context.Expandable"
                         Icon="@context.Icon"
                         Visible="@context.Visible"
                         LoadingIconColor="Color.Info" />
    </ItemTemplate>
</MudTreeView>
