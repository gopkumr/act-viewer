@using Microsoft.AspNetCore.Authorization
@attribute [Authorize]

<MudTextField T="string" Label="Search" Class="flex-grow-0 mt-2 pt-0 pb-0 ml-2" Adornment="Adornment.End" Variant="Variant.Outlined" AdornmentIcon="@Icons.Material.Filled.Search" TextChanged="OnTextChanged" Immediate="true" Clearable="true" Style="width:90%; background:#FAFAFA;" />
<MudTreeView T="TreeViewItemViewModel" @ref="_treeView" FilterFunc="MatchesName" ServerData="@LoadServerData" Items="@Repositories">
    <ItemTemplate>
        <ShimmerLoad IsLoading="@_isLoading">
            <MudTreeViewItem Value="@context.Value"
                             Text="@context.Value.Name"
                             Items="@context.Children"
                             OnClick="@(()=> HandleItemClick(@context.Value))"
                             ItemsChanged="@(new Action<IReadOnlyCollection<TreeItemData<TreeViewItemViewModel>>>(items => OnItemsLoaded(context, items)))"
                             @bind-Expanded="@context.Expanded"
                             CanExpand="@context.Expandable"
                             Icon="@context.Icon"
                             Visible="@context.Visible"
                             LoadingIconColor="Color.Info"
                             IconColor="Color.Info" />
        </ShimmerLoad>
    </ItemTemplate>
</MudTreeView>
